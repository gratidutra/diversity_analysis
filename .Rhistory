# chamando as libs necessárias
pacman::p_load(tidyverse, magrittr, lubridate, iNEXT, vegan, RAM, permute)
# Partes cavalo -----------------------------------------------------------
df <- read_csv("data/partes_cavalo.csv")
setwd("~/Documents/diversity_analysis/cavalo")
setwd("~/Documents/diversity_analysis")
# Partes cavalo -----------------------------------------------------------
df <- read_csv("data/partes_cavalo.csv")
df <- df %>% mutate(`Espécie` = case_when(
`Espécie` == "Tabanus antarcticus" ~ "Tabanus antarticus",
`Espécie` == "Tabaus antarcticus" ~ "Tabanus antarticus",
`Espécie` == "Tabanus occidentalis var. dorsovittatus" ~ "Tabanus occidentalis",
`Espécie` == "Tabanus occidentalis var. modestus" ~ "Tabanus occidentalis",
`Espécie` == "Tabaus occidentalis var. modestus" ~ "Tabanus occidentalis",
`Espécie` == "Tabanus occidentalis var.modestus" ~ "Tabanus occidentalis",
`Espécie` == "Tabanus occidentalis var. ?dorsovittatus" ~ "Tabanus occidentalis",
`Espécie` == "Tabanus rupripes" ~ "Tabanus rubripes",
`Espécie` == "Tabanus ?fuscofasciatus" ~ "Tabanus fuscofasciatus",
`Espécie` == "Tabanus occiedntalis" ~ "Tabanus occidentalis", TRUE ~ `Espécie`
))
df
levels(df$`Local de pouso...4`)
unique(df$`Local de pouso...4`)
df %>% mutate(local_do_pouso_simplificado = case_when(`Local de pouso...4` == "Face" |
`Local de pouso...4` == "Pescoço" |
`Local de pouso...4` == "Narina" ~ "Cabeça",
`Local de pouso...4` == "Barriga" |
`Local de pouso...4` == "Aparelho genital"  ~ "Ventral",
`Local de pouso...4` == "Rabo" |
`Local de pouso...4` == "Quartela traseira"  ~ "Lombar",
`Local de pouso...4` == "Perna dianteira" |
`Local de pouso...4` == "Perna traseira"  ~ "Pernas",
TRUE ~ 'Frontal'
))
df <- df %>% mutate(local_do_pouso_simplificado = case_when(`Local de pouso...4` == "Face" |
`Local de pouso...4` == "Pescoço" |
`Local de pouso...4` == "Narina" ~ "Cabeça",
`Local de pouso...4` == "Barriga" |
`Local de pouso...4` == "Aparelho genital"  ~ "Ventral",
`Local de pouso...4` == "Rabo" |
`Local de pouso...4` == "Quartela traseira"  ~ "Lombar",
`Local de pouso...4` == "Perna dianteira" |
`Local de pouso...4` == "Perna traseira"  ~ "Pernas",
TRUE ~ 'Frontal'
))
df
View(df)
unique(df$local_do_pouso_simplificado)
collect_by_horse <- df %>% group_by(local_do_pouso_simplificado) %>%
summarise(total = n()) %>%
arrange(-total) %>% filter(total >= 8)
collect_by_horse
ggplot(collect_by_horse, aes(as.factor(local_do_pouso_simplificado), total, fill = total)) +
geom_bar(binwidth = 1, stat = "identity") +
theme_light() +
scale_fill_gradient(low = "white", high = "black") +
facet_wrap(~`Local de pouso`) +
ylab("Abundance") +
xlab("Hour") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))
ggplot(collect_by_horse, aes(as.factor(local_do_pouso_simplificado), total, fill = total)) +
geom_bar(binwidth = 1, stat = "identity") +
theme_light() +
scale_fill_gradient(low = "white", high = "black")
ggplot(collect_by_horse, aes(as.factor(local_do_pouso_simplificado), total, fill = total)) +
geom_bar(binwidth = 1, stat = "identity") +
theme_light() +
scale_colour_grey()+
ylab("Abundance") +
xlab("Hour") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))
ggplot(collect_by_horse, aes(as.factor(local_do_pouso_simplificado), as.factor(total), fill = total)) +
geom_bar(binwidth = 1, stat = "identity") +
theme_light() +
scale_colour_grey()+
ylab("Abundance") +
xlab("Hour") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))
ggplot(collect_by_horse, aes(as.factor(local_do_pouso_simplificado), as.factor(total), fill = total)) +
geom_bar(binwidth = 1, stat = "identity") +
theme_light() +
scale_fill_grey(start = 0.25, end = 0.75)+
ylab("Abundance") +
xlab("Hour") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))
ggplot(collect_by_horse, aes(as.factor(local_do_pouso_simplificado), as.factor(total), fill = total)) +
geom_bar() +
theme_light() +
scale_fill_grey(start = 0.25, end = 0.75)+
ylab("Abundance") +
xlab("Hour") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))
ggplot(local_do_pouso_simplificado, aes(as.factor(local_do_pouso_simplificado),
fill = as.factor(local_do_pouso_simplificado))) +
geom_bar() +
theme_light() +
scale_fill_grey(start = 0.25, end = 0.75)+
ylab("Abundance") +
xlab("Hour") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))
ggplot(df, aes(as.factor(local_do_pouso_simplificado),
fill = as.factor(local_do_pouso_simplificado))) +
geom_bar() +
theme_light() +
scale_fill_grey(start = 0.25, end = 0.75)+
ylab("Abundance") +
xlab("Hour") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))
ggplot(df, aes(as.factor(local_do_pouso_simplificado),
fill = as.factor(local_do_pouso_simplificado))) +
geom_bar() +
theme_light() +
scale_fill_grey(start = 0.25, end = 0.75)+
ylab("Abundance") +
xlab("Hour") +
theme(
legend. position = "none",
axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))
ggplot(df, aes(as.factor(local_do_pouso_simplificado),
fill = as.factor(local_do_pouso_simplificado))) +
geom_bar() +
theme_light() +
scale_fill_grey(start = 0.25, end = 0.75)+
ylab("Abundance") +
xlab("Hour") +
theme(
legend.position = "none",
axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))
